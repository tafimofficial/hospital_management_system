{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h2 style="margin-bottom: 20px; color: var(--primary-color);">Doctor Dashboard</h2>

    <div style="display: flex; gap: 20px; margin-bottom: 30px;">
        <div
            style="flex: 1; background: var(--white); padding: 20px; border-radius: 10px; box-shadow: var(--shadow); text-align: center;">
            <h3>My Profile</h3>
            {% if user.doctor_profile.profile_pic %}
            <img src="{{ user.doctor_profile.profile_pic.url }}" alt="Profile Picture"
                style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; margin: 15px 0;">
            {% else %}
            <div
                style="width: 100px; height: 100px; border-radius: 50%; background-color: #ddd; display: flex; align-items: center; justify-content: center; margin: 15px auto;">
                <i class="fas fa-user-md fa-3x" style="color: #aaa;"></i>
            </div>
            {% endif %}
            <p style="font-size: 1.2rem; font-weight: 600;">Dr. {{ user.get_full_name }}</p>
            <p style="color: var(--secondary-color); margin-bottom: 10px;">{{ user.doctor_profile.specialization }}</p>
            <a href="{% url 'doctor_profile' %}" class="btn" style="margin-top: 5px; width: 100%;">View Full Profile</a>
        </div>
        <div style="flex: 2; background: var(--white); padding: 20px; border-radius: 10px; box-shadow: var(--shadow);">
            <h3>Appointments</h3>
            {% if appointments %}
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background-color: var(--light-bg); text-align: left;">
                        <th style="padding: 10px;">Patient</th>
                        <th style="padding: 10px;">Date</th>
                        <th style="padding: 10px;">Time</th>
                        <th style="padding: 10px;">Description</th>
                        <th style="padding: 10px;">Status</th>
                        <th style="padding: 10px;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for appointment in appointments %}
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 10px;">{{ appointment.patient.get_full_name }}</td>
                        <td style="padding: 10px;">{{ appointment.date }}</td>
                        <td style="padding: 10px;">{{ appointment.time }}</td>
                        <td style="padding: 10px;">{{ appointment.description }}</td>
                        <td style="padding: 10px;">
                            <span style="padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; 
                                        {% if appointment.status == 'approved' %}background-color: #d4edda; color: #155724;
                                        {% elif appointment.status == 'declined' %}background-color: #f8d7da; color: #721c24;
                                        {% else %}background-color: #fff3cd; color: #856404;{% endif %}">
                                {{ appointment.get_status_display }}
                            </span>
                        </td>
                        <td style="padding: 10px;">
                            {% if appointment.status == 'pending' %}
                            <a href="{% url 'approve_appointment' appointment.id %}"
                                style="color: green; margin-right: 10px;"><i class="fas fa-check"></i></a>
                            <a href="{% url 'decline_appointment' appointment.id %}" style="color: red;"><i
                                    class="fas fa-times"></i></a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p>No appointments found.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}